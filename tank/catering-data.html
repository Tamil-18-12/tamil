<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>Event Data - Catering Event</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" />
    <style>
        /* Re-using the styles from catering-book.html for consistency */
        body {
            background: linear-gradient(113deg, #501F56, #19021C);
            min-height: 100vh;
            margin: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #f1f1f1;
            display: flex;
            flex-direction: column;
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 32px;
            background: linear-gradient(135deg, #501F56, #19021C);
            border-bottom: 1px solid rgba(252, 220, 59, 0.25);
            position: sticky;
            top: 0;
            z-index: 99;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
        }

        .logo img {
            height: 54px;
            width: 54px;
            border-radius: 12px;
            object-fit: cover;
        }

        nav ul {
            list-style: none;
            display: flex;
            gap: 28px;
            margin: 0;
            padding: 0;
            font-weight: 700;
        }

        nav ul li {
            cursor: pointer;
            padding: 8px 16px;
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 1.2px;
            border-radius: 22px;
            color: #ddd;
            transition: all 0.3s ease;
        }

        nav ul li:hover {
            background: #fcdc3b;
            color: #3a1d59;
            box-shadow: 0 0 12px #fcdc3b;
        }

        .container {
            /* Made the container wider to better fit the table */
            max-width: 960px;
            margin: 60px auto;
            background: rgba(255, 255, 255, 0.1);
            padding: 40px 30px;
            border-radius: 18px;
            box-shadow: 0 15px 40px rgba(252, 220, 59, 0.4);
            border: 2px solid #fcdc3b;
            backdrop-filter: blur(10px);
        }

        h2 {
            text-align: center;
            font-size: 2.4rem;
            font-weight: 900;
            margin-bottom: 35px;
            text-shadow: 2px 2px 8px #3a1d59;
        }

        /* Custom styles for the data table */
        .table-responsive {
            border-radius: 10px;
            overflow: hidden;
        }

        .table {
            background-color: rgba(0, 0, 0, 0.3);
            color: #f1f1f1;
        }

        .table thead th {
            color: #fcdc3b;
            background-color: rgba(0, 0, 0, 0.5);
            border-bottom: 2px solid #fcdc3b;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .table tbody tr {
            transition: background-color 0.3s ease;
        }

        .table tbody tr:hover {
            background-color: rgba(252, 220, 59, 0.15);
        }

        .table td,
        .table th {
            border-top: 1px solid rgba(252, 220, 59, 0.2);
            vertical-align: middle;
        }

        .btn-clear {
            background-color: #dc3545;
            border-color: #dc3545;
            color: white;
            font-weight: bold;
            border-radius: 15px;
            transition: all 0.3s ease;
        }

        .btn-clear:hover {
            background-color: #c82333;
            border-color: #bd2130;
            transform: scale(1.05);
        }

        .no-events {
            text-align: center;
            font-size: 1.5rem;
            padding: 50px 0;
            opacity: 0.8;
        }
    </style>
</head>

<body>

    <nav>
        <div class="logo"><img src="logo.png" alt="Logo"></div>
        <ul>
            <li onclick="navigateTo('home.html')">Home</li>
            <li onclick="navigateTo('about.html')">About</li>
            <li onclick="navigateTo('contact.html')">Contact</li>
            <li onclick="navigateTo('review.html')">Review</li>
        </ul>
    </nav>

    <div class="container">
        <h2>Catering Event Bookings</h2>
        <div id="eventDataContainer">
        </div>
    </div>

    <script>
        function navigateTo(url) {
            window.location.href = url;
        }

        const eventDataContainer = document.getElementById('eventDataContainer');

        /**
         * Formats a datetime-local string into a more readable format.
         * @param {string} dateString The input string from datetime-local.
         * @returns {string} A formatted date and time string.
         */
        function formatDate(dateString) {
            if (!dateString) return 'N/A';
            const options = {
                year: 'numeric', month: 'short', day: 'numeric',
                hour: '2-digit', minute: '2-digit', hour12: true
            };
            const date = new Date(dateString);
            return date.toLocaleString('en-US', options);
        }

        /**
         * Deletes an event from localStorage and re-renders the list.
         * @param {number} index The index of the event to delete.
         */
        function deleteEvent(index) {
            // Retrieve the current list of events
            let events = JSON.parse(localStorage.getItem('catering_events') || '[]');

            // Remove the event at the specified index
            events.splice(index, 1);

            // Save the updated list back to localStorage
            localStorage.setItem('catering_events', JSON.stringify(events));

            // Re-render the event list on the page
            displayEvents();
        }

        /**
         * Fetches events from localStorage and displays them in a table.
         */
        function displayEvents() {
            const events = JSON.parse(localStorage.getItem('catering_events') || '[]');

            // Clear any previous content
            eventDataContainer.innerHTML = '';

            // If there are no events, show a message
            if (events.length === 0) {
                eventDataContainer.innerHTML = `<p class="no-events">ðŸŽ‰ No events have been booked yet. ðŸŽ‰</p>`;
                return;
            }

            // Create the table structure
            const table = document.createElement('table');
            table.className = 'table table-hover';

            table.innerHTML = `
                <thead>
                    <tr>
                        <th>Location</th>
                        <th>Start Time</th>
                        <th>End Time</th>
                        <th>Members</th>
                        <th>Amount (â‚¹)</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="event-list-body">
                </tbody>
            `;

            const tbody = table.querySelector('#event-list-body');

            // Populate the table body with event data
            events.forEach((event, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${event.location}</td>
                    <td>${formatDate(event.dateStart)}</td>
                    <td>${formatDate(event.dateEnd)}</td>
                    <td>${event.members}</td>
                    <td>${event.amount.toFixed(2)}</td>
                    <td>
                        <button class="btn btn-sm btn-clear" onclick="deleteEvent(${index})">Clear</button>
                    </td>
                `;
                tbody.appendChild(row);
            });

            // Wrap table in a responsive div and add it to the container
            const tableWrapper = document.createElement('div');
            tableWrapper.className = 'table-responsive';
            tableWrapper.appendChild(table);

            eventDataContainer.appendChild(tableWrapper);
        }

        // Add an event listener to call displayEvents when the page is fully loaded
        document.addEventListener('DOMContentLoaded', displayEvents);
    </script>

</body>

</html>