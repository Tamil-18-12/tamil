<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sweet Event Stalls</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #501F56, #19021C);
            color: white;
            min-height: 100vh;
        }

        nav {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px 24px;
            background: linear-gradient(135deg, #501F56, #19021C);
            border-bottom: 1px solid rgba(255, 255, 255, 0.13);
            position: relative;
            z-index: 99;
        }

        .logo img {
            height: 48px;
            width: 48px;
            object-fit: cover;
        }

        nav ul {
            list-style: none;
            display: flex;
            gap: 26px;
            font-weight: bold;
            margin: 0;
        }

        nav ul li {
            position: relative;
            cursor: pointer;
            font-weight: 900;
            padding: 6px 10px;
            font-size: 1rem;
            transition: color 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-radius: 17px;
            display: inline-block;
        }

        nav ul li::after {
            content: "";
            display: block;
            position: absolute;
            left: 20%;
            bottom: 2px;
            width: 60%;
            height: 3px;
            background: #fcdc3b;
            border-radius: 2px;
            transform: scaleX(0);
            transition: transform 0.3s;
        }

        nav ul li:hover {
            color: #fcdc3b;
            background: rgba(252, 220, 59, 0.08);
        }

        nav ul li:hover::after {
            transform: scaleX(1);
        }

        .joi {
            padding: 6px 20px;
            background-color: gold;
            color: black;
            border-radius: 30px;
            font-size: 1rem;
            font-weight: bold;
            display: inline-block;
            margin-top: 4px;
            box-shadow: 0 4px 18px #fcdc3b59;
            letter-spacing: 1px;
        }

        .event-card img {
            height: 200px;
            object-fit: cover;
            border-top-left-radius: 0.5rem;
            border-top-right-radius: 0.5rem;
        }

        .event-card {
            border-radius: 0.5rem;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
    </style>
</head>

<body>

    <nav>
        <div class="logo">
            <img src="logo.png" alt="Logo" />
        </div>
        <ul>
            <li onclick="navigateTo('home.html')">Home</li>
            <li onclick="navigateTo('about.html')">About</li>
            <li onclick="navigateTo('contact.html')">Contact</li>
            <li onclick="navigateTo('review.html')">Review</li>
            <li onclick="navigateTo('join.html')"><span class="joi">Join Us</span></li>
        </ul>
    </nav>

    <div class="container mt-5">
        <div class="text-center mb-4">
            <h1 class="text-dark">Available Sweet Stall Events</h1>
        </div>

        <div class="row" id="eventListContainer"></div>

        <div class="row justify-content-center d-none" id="noDataRow">
            <div class="col-md-6">
                <div class="card shadow-lg">
                    <div class="card-header text-center bg-dark text-white">
                        <h2>No Events Found</h2>
                    </div>
                    <div class="card-body text-center">
                        <p class="lead">Currently, there are no stalls available.</p>
                        <p>Please check back later.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Booking Modal -->
    <div class="modal fade" id="bookingModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Book Stall: <span id="stallName"></span></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="bookingForm">
                        <input type="hidden" id="formStallNameInput">
                        <div class="mb-3">
                            <label for="customerName" class="form-label">Full Name</label>
                            <input type="text" class="form-control" id="customerName" required>
                        </div>
                        <div class="mb-3">
                            <label for="whatsappNumber" class="form-label">WhatsApp Number</label>
                            <input type="tel" class="form-control" id="whatsappNumber" required>
                        </div>
                        <div class="mb-3">
                            <label for="address" class="form-label">Address</label>
                            <textarea class="form-control" id="address" rows="3" required></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="bookingDate" class="form-label">Date</label>
                            <input type="date" class="form-control" id="bookingDate" required>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            <button type="submit" class="btn btn-primary">Book Now</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        window.onload = function () {
            const eventListContainer = document.getElementById('eventListContainer');
            const noDataRow = document.getElementById('noDataRow');
            const STORAGE_KEY = 'sweetEvents';

            const eventsJSON = localStorage.getItem(STORAGE_KEY);
            const events = eventsJSON ? JSON.parse(eventsJSON) : [];

            if (events.length > 0) {
                eventListContainer.innerHTML = '';
                noDataRow.classList.add('d-none');

                events.forEach(event => {
                    const cardHTML = `
                        <div class="col-md-6 col-lg-4 mb-4">
                            <div class="card shadow-lg event-card h-100">
                                <img src="${event.mainImage}" alt="${event.travelsName}" class="w-100">
                                <div class="card-body text-center">
                                    <h3 class="card-title h5 mb-2">${event.travelsName}</h3>
                                    <p class="card-text fw-normal h6">Rate Per Day: â‚¹${event.pricePerDay}</p>
                                </div>
                                <div class="card-footer text-center">
                                     <button class="btn btn-dark" data-bs-toggle="modal" data-bs-target="#bookingModal" data-stall-name="${event.travelsName}">
                                        Book Stall
                                     </button>
                                </div>
                            </div>
                        </div>
                      `;
                    eventListContainer.innerHTML += cardHTML;
                });
            } else {
                eventListContainer.innerHTML = '';
                noDataRow.classList.remove('d-none');
            }
        };

        const bookingModal = document.getElementById('bookingModal');
        const bookingForm = document.getElementById('bookingForm');
        const BOOKINGS_STORAGE_KEY = 'sweetBookings';
        let myModal;

        bookingModal.addEventListener('show.bs.modal', function (event) {
            const button = event.relatedTarget;
            const stallName = button.getAttribute('data-stall-name');

            document.getElementById('stallName').textContent = stallName;
            document.getElementById('formStallNameInput').value = stallName;

            myModal = new bootstrap.Modal(bookingModal);
        });

        bookingForm.addEventListener('submit', function (e) {
            e.preventDefault();

            const bookingDetails = {
                stall: document.getElementById('formStallNameInput').value,
                customer: document.getElementById('customerName').value,
                whatsapp: document.getElementById('whatsappNumber').value,
                address: document.getElementById('address').value,
                date: document.getElementById('bookingDate').value,
            };

            const existingBookingsJSON = localStorage.getItem(BOOKINGS_STORAGE_KEY);
            const existingBookings = existingBookingsJSON ? JSON.parse(existingBookingsJSON) : [];

            existingBookings.push(bookingDetails);
            localStorage.setItem(BOOKINGS_STORAGE_KEY, JSON.stringify(existingBookings));

            bookingForm.reset();
            myModal.hide();
            alert('Stall booked successfully!');
        });

        function navigateTo(page) {
            window.location.href = page;
        }
    </script>

</body>

</html>